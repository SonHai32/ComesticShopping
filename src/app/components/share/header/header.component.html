<nz-affix>
  <div class="container-fluid">
    <div class="row base-background py-4">
      <div
        class="
          col-md-2 col-xs-12
          d-flex
          align-items-center
          justify-content-center
          flex-row
        "
      >
        <h1 class="text-danger text-center">Logo</h1>
      </div>
      <div class="col-md-6 col-xs-12">
        <ul
          class="
            navbar-nav
            flex-row
            justify-content-center
            align-items-center
            h-100
          "
        >
          <li class="nav-item mx-3" *ngFor="let item of navItems">
            <a class="nav-link text-dark" routerLink="[item.path]">
              {{ item.name }}</a
            >
          </li>
        </ul>
      </div>
      <div
        class="
          col-xs-12 col-md-3
          d-flex
          flex-row
          align-items-center
          justify-content-center
        "
      >
        <div
          [routerLink]="['/auth']"
          routerLinkActive="active"
          [nzPopoverContent]="isLoggedIn ? userPopoverLoginedTmp : ''"
          nz-popover
          nzPopoverPlacement="bottom"
          nzPopoverTrigger="hover"
          class="
            user
            mx-2
            py-3
            px-4
            pointer
            icon-item
            d-flex
            align-items-center
          "
        >
          <ng-template #userPopoverUnLoggedInTmp>
            <div
              class="
                user-popover-logout
                d-flex
                align-items-end
                justify-content-center
              "
            >
              <span class="login-text" nz-typography>Bạn chưa đăng nhập</span>
              <button class="mx-1" nz-button nzBlock nzType="primary">
                Đăng nhập
              </button>
              <button class="mx-1" nz-button nzBlock nzType="primary">
                Đăng ký
              </button>
            </div>
          </ng-template>
          <ng-template #userPopoverLoginedTmp>
            <div class="user-popover">
              <div nz-menu class="w-100 border-0">
                <li
                  nz-menu-item
                  class="user-pop-over-item d-flex align-items-center"
                >
                  <i nz-icon nzType="user" nzTheme="outline"></i>
                  <span>Tài khoản của tôi</span>
                </li>
                <li
                  nz-menu-item
                  class="user-pop-over-item d-flex align-items-center"
                >
                  <i nz-icon nzType="lock" nzTheme="outline"></i>
                  <span>Đổi mật khẩu</span>
                </li>

                <li
                  nz-menu-item
                  class="user-pop-over-item d-flex align-items-center"
                >
                  <i nz-icon nzType="shopping" nzTheme="outline"></i>
                  <span>Giỏ hàng</span>
                </li>
                <li
                  nz-menu-item
                  class="user-pop-over-item d-flex align-items-center"
                >
                  <i nz-icon nzType="bell" nzTheme="outline"></i>
                  <span>Thông báo</span>
                </li>
              </div>
              <button nz-button (click)="logOut()" nzBlock nzType="primary">
                Đăng xuất
              </button>
            </div>
          </ng-template>

          <i nz-icon nzType="user" nzTheme="outline"></i>
          <span class="none-select mx-2">Tài khoản</span>
        </div>

        <nz-badge [nzCount]="totalCart" [nzOffset]="[-30, 10]">
          <div
            class="
              cart
              mx-2
              py-3
              px-4
              pointer
              icon-item
              d-flex
              align-items-center
            "
            [nzPopoverContent]="cartListItemTmp"
            nz-popover
            nzPopoverPlacement="bottom"
            nzPopoverTrigger="hover"
          >
            <i nz-icon nzType="shopping-cart" nzTheme="outline"></i>
            <span class="none-select mx-2">Giỏ hàng</span>
            <ng-template #cartListItemTmp>
              <div class="cart-list-item-popover">
                <cdk-virtual-scroll-viewport
                  *ngIf="listCart.length > 0"
                  itemSize="60"
                  class="w-100 h-75 custom-scroll-bar p-1"
                >
                  <nz-list>
                    <nz-list-item *cdkVirtualFor="let item of listCart">
                      <nz-list-item-meta
                        *ngIf="item"
                        nzAvatar="{{ item.product.product_img_urls[0] }}"
                        [nzDescription]="cartItemLinkTmp"
                      >
                        <ng-template #cartItemLinkTmp>
                          <a
                            [routerLink]="['product-detail', item.product.id]"
                            >{{ item.product.product_name }}</a
                          >
                        </ng-template>

                        <nz-list-item-meta-title>
                          <span nz-typography
                            ><strong>Đơn giá: </strong>
                            <span nz-typography nzType="danger">
                              {{
                                item.product.product_price
                                  | currency: "VND":"symbol"
                              }}
                            </span></span
                          >
                        </nz-list-item-meta-title>
                        <nz-list-item-meta-title>
                          <span nz-typography
                            ><strong>Số lượng: </strong>
                            <span nz-typography nzType="danger">
                              {{ item.amount }}
                            </span></span
                          >
                        </nz-list-item-meta-title>
                      </nz-list-item-meta>
                    </nz-list-item>
                  </nz-list>
                </cdk-virtual-scroll-viewport>
                <nz-divider
                  nzOrientation="center"
                  nzType="horizontal"
                  class="m-0"
                ></nz-divider>
                <button
                  *ngIf="listCart.length > 0"
                  nz-button
                  nzBlock
                  class="mt-3"
                  nzType="dashed"
                  [routerLink]="['/default', 'cart-detail']"
                >
                  Thanh toán ngay
                </button>
                <div
                  *ngIf="listCart.length == 0"
                  class="w-100 h-100 d-flex flex-column align-items-center justify-content-center"
                >
                  <img src="assets/images/empty.png" alt="" class="img-fluid" />
                  <button
                    nz-button
                    nzBlock
                    class="mt-3"
                    nzType="dashed"
                    [routerLink]="['/default', 'product']"
                  >
                    Tiếp tục mua sắm
                  </button>
                </div>
              </div>
            </ng-template>
          </div>
        </nz-badge>
      </div>
    </div>
  </div>
</nz-affix>
